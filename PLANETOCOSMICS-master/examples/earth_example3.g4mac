##############################################################
#Example3 for the Earth
#Visualisation of particle trajectories in different magnetic field models 
# 
##############################################################
/control/verbose 1


/PLANETOCOS/SPACECOORDINATE/UseSpice true
/PLANETOCOS/InitialiseForMagneticShieldingStudy
/PLANETOCOS/BFIELD/SwitchOn



/tracking/verbose 0
/tracking/storeTrajectory 1
/vis/scene/endOfEventAction accumulate
/control/verbose 1




/PLANETOCOS/DRAW/DrawPoints false
/PLANETOCOS/DRAW/DrawTrajectory true



#
#DIPOLE  trapped particle
#


/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRFTiltedDipole
/PLANETOCOS/BFIELD/SetExternalFieldModel NOFIELD
/PLANETOCOS/DRAW/SetCoordinateSystem MAG

/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .1 rplanet
/gps/particle proton
/gps/energy 100 MeV
/PLANETOCOS/SOURCE/SetDirectionVector MAG 0. 1. 1.
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton 1 0 0
/PLANETOCOS/SOURCE/SetPositionVector MAG 3. 0. 0. rplanet
/PLANETOCOS/STOPCONDITION/SetMaxTrackLength 1000 rplanet
/PLANETOCOS/STOPCONDITION/SetMaxTrackDuration 4. second
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton  0 1 0
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetColourForBline 1 1 1
/PLANETOCOS/SOURCE/SetPositionVector GSM 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline




/vis/open VRML2FILE
/vis/viewer/create 
/vis/viewer/set/viewpointThetaPhi 0. 90. deg
/vis/viewer/zoom .35
/vis/viewer/set/style surface2
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false



#
#proton 1 MeV in dipole
#


/gps/particle proton
/gps/energy 1. MeV
/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .1 rplanet
/PLANETOCOS/SOURCE/SetDirectionVector MAG 0. 1. 1.
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton 1 0 0
/PLANETOCOS/SOURCE/SetPositionVector MAG 3. 0. 0. rplanet
/PLANETOCOS/STOPCONDITION/SetMaxTrackLength 1000 rplanet
/PLANETOCOS/STOPCONDITION/SetMaxTrackDuration 20. second
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/DRAW/SetParticleTrajectoryColour  0 1 0
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/vis/viewer/create 
/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false

#
#motion in equatorial plane in dipole
#


/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .1 rplanet
/PLANETOCOS/SOURCE/SetPositionVector MAG 4. 0. 0. rplanet 
/PLANETOCOS/SOURCE/SetDirectionVector MAG 0. -1. 0.
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 0 0
/PLANETOCOS/SOURCE/SetRigidity 5. GV
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 1 0
/PLANETOCOS/SOURCE/SetRigidity 4. GV
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1


/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 0 1
/PLANETOCOS/SOURCE/SetRigidity 3.9 GV
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 1 0
/PLANETOCOS/SOURCE/SetRigidity 3.65 GV
/PLANETOCOS/MAGNETIC/ComputeTrajectories 1
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false

#
#Particle backward from earth in different field model
#



/PLANETOCOS/BFIELD/SetInternalFieldModel IGRFEccentricTiltedDipole
/PLANETOCOS/BFIELD/SetExternalFieldModel NOFIELD
/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .1 rplanet

/PLANETOCOS/DRAW/DrawTrajectory true
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM

/gps/particle proton
/PLANETOCOS/SOURCE/SetRigidity  5. GV
/PLANETOCOS/SOURCE/SetPosition GEODETIC  20. km  46.55  7.98 degree
/PLANETOCOS/SOURCE/SetDirection GEODETIC 0. 0. degree 
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/BFIELD/SetInternalFieldModel IGRF
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 1 0
/PLANETOCOS/SOURCE/SetRigidity  5. GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/BFIELD/SetExternalFieldModel TSY96
/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 0 1
/PLANETOCOS/SOURCE/SetRigidity  5. GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1


/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false


