##############################################################
#Example3 for the Earth
#Visualisation of particle trajectories in different magnetic field models 
# 
##############################################################
/control/verbose 1


/PLANETOCOS/SPACECOORDINATE/UseSpice true
/PLANETOCOS/InitialiseForMagneticShieldingStudy
/PLANETOCOS/BFIELD/SwitchOn

/tracking/verbose 0
/control/verbose 1
/tracking/storeTrajectory 1
/vis/scene/endOfEventAction accumulate

/vis/open VRML2FILE
/vis/scene/create
/vis/viewer/set/viewpointThetaPhi 0 0 deg
/vis/viewer/zoom 2

/PLANETOCOS/DRAW/DrawTrajectory true
/PLANETOCOS/DRAW/SetCoordinateSystem GEODETIC

/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel TSY2004
/PLANETOCOS/BFIELD/SetPdyn 2
/PLANETOCOS/BFIELD/SetDst 0 nT
/PLANETOCOS/BFIELD/SetImfBy 0 nT
/PLANETOCOS/BFIELD/SetImfBz 1 nT
/PLANETOCOS/BFIELD/SetW1 0
/PLANETOCOS/BFIELD/SetW2 0
/PLANETOCOS/BFIELD/SetW3 0
/PLANETOCOS/BFIELD/SetW4 0
/PLANETOCOS/BFIELD/SetW5 0
/PLANETOCOS/BFIELD/SetW6 0
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM
/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .1 rplanet

/gps/particle proton
/PLANETOCOS/SOURCE/SetPosition GEODETIC  400. km  -51  80 degree
/PLANETOCOS/SOURCE/SetDirection GEODETIC 0. 0. degree 

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 1 1
/PLANETOCOS/SOURCE/SetRigidity  0.01 GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 0 0
/PLANETOCOS/SOURCE/SetRigidity  0.1 GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 0 1
/PLANETOCOS/SOURCE/SetRigidity  0.5 GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   1 1 0
/PLANETOCOS/SOURCE/SetRigidity  1. GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 1 0
/PLANETOCOS/SOURCE/SetRigidity  10. GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/SetParticleTrajectoryColour proton   0 0 1
/PLANETOCOS/SOURCE/SetRigidity  100. GV
/PLANETOCOS/MAGNETIC/ComputeReverseTrajectories 1

/PLANETOCOS/DRAW/Show
