##############################################################
#Example1 for the Earth
#Drawing of magnetic field lines in different models of Earth's magnetic field 
#
#############################################################

#
#Initialisation
#

/control/verbose 1
/PLANETOCOS/SPACECOORDINATE/UseSpice true
/PLANETOCOS/InitialiseForMagneticShieldingStudy
/PLANETOCOS/BFIELD/SwitchOn




/tracking/verbose 0
/tracking/storeTrajectory 1
/vis/scene/endOfEventAction accumulate
/control/verbose 1


#
#The step length should be small enough to obtain a smooth drawing
#


/PLANETOCOS/USERLIMIT/SetMagnetoMaxStepLength .2 rplanet


#
#Drawing of trajectories
#

/PLANETOCOS/DRAW/DrawPoints false
/PLANETOCOS/DRAW/DrawTrajectory true



#
#GEOMAGNETIC DIPOLE 
#

/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRFTiltedDipole
/PLANETOCOS/BFIELD/SetExternalFieldModel NOFIELD
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem MAG


/PLANETOCOS/SOURCE/SetPositionVector MAG 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 45. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 90.  degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 135. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 180. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 225. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 270. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 315. degree 
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition MAG 3 rplanet  0. 360. degree 
/PLANETOCOS/DRAW/TraceBline


#
#Select visualisation driver and draw the field lines for the first case
#
#change the next line to select your visualisation driver

#/vis/open OGLIX
/vis/scene/create
/vis/open VRML2FILE
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset


#
#IGRF 
#

/vis/enable false
/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel NOFIELD
/PLANETOCOS/DRAW/SetColourForBline 0 1 0
/PLANETOCOS/DRAW/SetCoordinateSystem MAG

/PLANETOCOS/SOURCE/SetPositionVector MAG 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG 10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG -2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG -4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG -6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG -8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector MAG -10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline




/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
#/vis/viewer/flush
/vis/enable false



#
#TSY89
#

/vis/enable false
/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel TSY89
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM

/PLANETOCOS/SOURCE/SetPositionVector GSM 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline

/PLANETOCOS/SOURCE/SetPositionVector GSM -2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -15. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  80. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -80. 180. degree
/PLANETOCOS/DRAW/TraceBline


/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
#/vis/viewer/flush
/vis/enable false

#
#TSY96
#
#
/vis/enable false
/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel TSY96
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM

/PLANETOCOS/SOURCE/SetPositionVector GSM 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline

/PLANETOCOS/SOURCE/SetPositionVector GSM -2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -15. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  80. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -80. 180. degree
/PLANETOCOS/DRAW/TraceBline


/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false




#
#TSY2001
#

/vis/enable false
/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel TSY2001
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM

/PLANETOCOS/SOURCE/SetPositionVector GSM 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 9.8 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline

/PLANETOCOS/SOURCE/SetPositionVector GSM -2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -15. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  80. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -80. 180. degree
/PLANETOCOS/DRAW/TraceBline



/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false

#
#TSY2001
#

/vis/enable false
/PLANETOCOS/BFIELD/SetStartDate 1995 3 23 12 0 0
/PLANETOCOS/BFIELD/SetInternalFieldModel  IGRF
/PLANETOCOS/BFIELD/SetExternalFieldModel TSY2004
/PLANETOCOS/BFIELD/SetPdyn 2
/PLANETOCOS/BFIELD/SetDst 0 nT
/PLANETOCOS/BFIELD/SetImfBy 0 nT
/PLANETOCOS/BFIELD/SetImfBz 1 nT
/PLANETOCOS/BFIELD/SetW1 0
/PLANETOCOS/BFIELD/SetW2 0
/PLANETOCOS/BFIELD/SetW3 0
/PLANETOCOS/BFIELD/SetW4 0
/PLANETOCOS/BFIELD/SetW5 0
/PLANETOCOS/BFIELD/SetW6 0
/PLANETOCOS/DRAW/SetColourForBline 1 0 0
/PLANETOCOS/DRAW/SetCoordinateSystem GSM

/PLANETOCOS/SOURCE/SetPositionVector GSM 2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM 9.8 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline

/PLANETOCOS/SOURCE/SetPositionVector GSM -2. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -4. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -6. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -8. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -10. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPositionVector GSM -15. 0. 0. rplanet
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -85. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  80. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/SOURCE/SetPosition GSM 40. km  -80. 180. degree
/PLANETOCOS/DRAW/TraceBline
/PLANETOCOS/BFIELD/PrintTSY2004Parameters



/vis/enable true
/PLANETOCOS/DRAW/Show
/vis/viewer/update
/PLANETOCOS/DRAW/Reset
/vis/enable false









